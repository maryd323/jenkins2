pipeline{
   agent any
   environment {
      gitRepo           = 'https://github.com/maryd323/jenkins2.git'
      wasPassword       = 'wpsadmin'
      portalPassword    = 'wpsadmin'
      appName           = 'CustomHTMLEditor'
      earFileName       = 'CustomHTMLEditor.ear'
      custmoWorkspace   = '${JENKINS_HOME}/buildconfig/'
   }
   stages {
      stage('Preparation') { 
         steps {
            git 'https://github.com/maryd323/jenkins2.git'
         }
      }
      stage('Build') {
         steps {
            withAnt (installation: 'JenkinsAnt') {
               script {
                  if (isUnix()) {
                     sh "'${antHome}/bin/ant' makezips"
                  } else {
                     bat(/"${antHome}\bin\ant" makezips/)
                  }
               }
            }
         }
      }
      stage('Results') {
         steps {
            archiveArtifacts 'build/dist/*.ear'
         }
      }
      stage('Publish'){
         steps {
            sh "'env'"
         }
      }
   }
}
