pipeline{
   agent any
   environment {
      wasPassword       = 'wpsadmin'
      portalPassword    = 'wpsadmin'
      appName           = 'CustomHTMLEditor'
      earFileName       = 'CustomHTMLEditor.ear'
      antHome           = tool 'Ant'
   }
   stages {
      stage('Retrieve') { 
         steps {
            git 'https://github.com/maryd323/jenkins2.git'
         }
      }
      stage('Build') {
         steps {
            step {
               sh "'${antHome}/bin/ant' makezips"
            }
         }
      }
      stage('Store') {
         steps {
            step {
               archiveArtifacts 'build/dist/*.ear'
            }
            step {
                  script {
                     copyArtifacts filter: 'build/dist/*.ear', 
                     fingerprintArtifacts: true, 
                     projectName: 'build-local-app', 
                     selector: upstream(fallbackToLastSuccessful: true)
               }
            }
         }
      }   
      stage('Publish'){
         steps {
            build 'deploy-local-app'
            sh "'env'"
            }
      }
   }
}
